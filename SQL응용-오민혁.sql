DROP DATABASE IF EXISTS 민혁대학;
-- DB 생성
CREATE DATABASE IF NOT EXISTS 민혁대학;
USE 민혁대학;

CREATE TABLE 교수(
	교수번호 VARCHAR(11) PRIMARY KEY NOT NULL UNIQUE,
    교수이름 VARCHAR(20) NOT NULL,
    교수주민번호 VARCHAR(20) NOT NULL UNIQUE,
    교수주소 VARCHAR(5) NOT NULL,
    교수전화번호 VARCHAR(20) NOT NULL UNIQUE,
    교수이메일 VARCHAR(20) NOT NULL UNIQUE,
    학과번호 VARCHAR(20) NOT NULL
);
SELECT * FROM 교수;

CREATE TABLE 강좌 (
	강좌번호 VARCHAR(20) PRIMARY KEY NOT NULL,
    강좌명 VARCHAR(20) NOT NULL UNIQUE,
    취득학점 VARCHAR(20) NOT NULL,
    강의시간 INT NOT NULL,
    강의실 VARCHAR(20) NOT NULL,
    담당교수번호 VARCHAR(11) NOT NULL,
    FOREIGN KEY (담당교수번호) REFERENCES 교수(교수번호)
);
SELECT * FROM 강좌;

CREATE TABLE 학생 (
	학생번호 VARCHAR(20) PRIMARY KEY NOT NULL,
    학생이름 VARCHAR(20) NOT NULL,
    학생주민번호 VARCHAR(20) NOT NULL UNIQUE,
    학생주소 VARCHAR(50) NOT NULL,
    학생전화번호 VARCHAR(20) NOT NULL UNIQUE,
    학생이메일 VARCHAR(20) NOT NULL UNIQUE,
    담당교수번호 VARCHAR(11) ,
    학과번호 VARCHAR(20) NOT NULL,
    강좌번호 VARCHAR(20),
    FOREIGN KEY (담당교수번호) REFERENCES 교수(교수번호),
    FOREIGN KEY(강좌번호) REFERENCES 강좌(강좌번호)
);
SELECT * FROM 학생;

CREATE TABLE 수강내역(
	출석점수 VARCHAR(20) NOT NULL,
	중간고사점수 VARCHAR(20) NOT NULL,
	기말고사점수 VARCHAR(20) NOT NULL,
	기타점수 VARCHAR(20) NOT NULL,
	총점 VARCHAR(20) NOT NULL,
	평점 VARCHAR(20) NOT NULL,
	학생번호 VARCHAR(20) NOT NULL,
	담당교수번호 VARCHAR(20) NOT NULL,
    -- FOREIGN KEY (학생번호,담당교수번호) REFERENCES 학생(학생번호,담당교수번호),
	FOREIGN KEY (담당교수번호) REFERENCES 학생(담당교수번호),
	FOREIGN KEY (학생번호) REFERENCES 학생(학생번호)
);
SELECT * FROM 수강내역;

CREATE TABLE 학과(
	교수번호 VARCHAR(20) NOT NULL,
    학생번호 VARCHAR(20) NOT NULL,
    학과번호 VARCHAR(20) NOT NULL,
    학과명 VARCHAR(20) NOT NULL,
    학과전화번호 VARCHAR(20) NOT NULL,
    FOREIGN KEY (교수번호) REFERENCES 교수(교수번호),
    FOREIGN KEY (학생번호) REFERENCES 학생(학생번호)
);
SELECT * FROM 학과;
-- 데이터 삽입
INSERT INTO 교수 VALUES('10000000001','문도','650503-1234567','자운','010-1111-1111','mundo@naver.com','0001');
INSERT INTO 교수 VALUES('10000000002','삼겹살','650503-1234568','영등동','010-2222-2222','mundo1@naver.com','0001');
INSERT INTO 교수 VALUES('10000000003','소주에','650503-1234569','모현동','010-3333-3333','mundo2@naver.com','0002');
INSERT INTO 교수 VALUES('10000000004','김치구워서','650503-1234560','신동','010-4444-4444','mundo3@naver.com','0002');
INSERT INTO 교수 VALUES('10000000005','뚝딱','650503-1234510','마동','010-5555-5555','mundo4@naver.com','0003');
SELECT * FROM 교수;

INSERT INTO 강좌 VALUES('101','우주공학','5','200','본관 507호','10000000001');
INSERT INTO 강좌 VALUES('102','디도스의맛','5','200','본관 203호','10000000002');
INSERT INTO 강좌 VALUES('103','우는아기재우는법','5','200','별관 101호','10000000003');
INSERT INTO 강좌 VALUES('104','강좌하는법','5','100','동관 202호','10000000004');
SELECT * FROM 강좌;

INSERT INTO 학생 VALUES('20000000001','오민혁','980513-1111111','가석로214','010-3789-1111','igh0501@naver.com','10000000001','0001','101');
INSERT INTO 학생 VALUES('20000000002','오민혁','980513-1111112','가석로214','010-3789-2222','igh0502@naver.com','10000000001','0001','101');
INSERT INTO 학생 VALUES('20000000003','오민지','980513-1111113','가석로215','010-3789-3333','igh0503@naver.com','10000000001','0001','101');
INSERT INTO 학생 VALUES('20000000004','오민돌','980513-1111220','가석로216','010-3789-1130','igh0520@naver.com','10000000002','0002','102');
INSERT INTO 학생 VALUES('20000000005','오민구','980513-1111115','가석로217','010-3789-1115','igh0505@naver.com','10000000003','0001','103');
INSERT INTO 학생 VALUES('20000000006','오민정','980513-1111116','가석로218','010-3789-1116','igh0506@naver.com','10000000004','0002','104');
INSERT INTO 학생 VALUES('20000000007','오민장','980513-1111117','가석로219','010-3789-1117','igh0507@naver.com',null,'0003',null);
INSERT INTO 학생 VALUES('20000000008','오민속','980513-1111118','가석로210','010-3789-1118','igh0508@naver.com',null,'0003',null);
INSERT INTO 학생 VALUES('20000000009','오민슥','980513-1111119','가석로220','010-3789-1119','igh0509@naver.com',null,'0004',null);
INSERT INTO 학생 VALUES('20000000010','오민슉','980513-1111110','가석로221','010-3789-1110','igh0510@naver.com',null,'0004',null);
SELECT * FROM 학생;

SELECT * FROM 학생 WHERE 강좌번호 IS NOT NULL;

INSERT INTO  수강내역 VALUES('100','100','100','100','400','100','20000000001','10000000001');
INSERT INTO  수강내역 VALUES('80','80','80','80','320','80','20000000002','10000000001');
INSERT INTO  수강내역 VALUES('70','70','70','70','280','70','20000000003','10000000001');
INSERT INTO  수강내역 VALUES('50','50','50','50','200','50','20000000004','10000000002');
INSERT INTO  수강내역 VALUES('65','65','65','65','260','65','20000000005','10000000002');
INSERT INTO  수강내역 VALUES('70','70','70','70','280','70','20000000006','10000000002');
INSERT INTO  수강내역 VALUES('50','50','50','50','200','50','20000000007','10000000003');
INSERT INTO  수강내역 VALUES('100','100','100','100','400','400','20000000008','10000000003');
INSERT INTO  수강내역 VALUES('50','50','50','50','200','50','20000000009','10000000004');
INSERT INTO  수강내역 VALUES('100','100','100','100','400','400','20000000010','10000000004');
SELECT * FROM 수강내역;


INSERT INTO 학과 VALUES('10000000001','20000000001','0001','인론학과','063-111-1111');
INSERT INTO 학과 VALUES('10000000002','20000000002','0001','컴퓨터학과','063-222-2222');
INSERT INTO 학과 VALUES('10000000003','20000000003','0001','가정의학과','063-333-3333');
INSERT INTO 학과 VALUES('10000000004','20000000004','0001','디지털전자정보과','063-333-4444');

SELECT * FROM 학과;
-- 학과명,학과번호 변경
UPDATE 학과
SET 학과명='컴퓨터공학과',
		학과번호='0111'
WHERE 학과명='컴퓨터학과';
SELECT * FROM 학과;

-- 교수별 담당학생 명단
CREATE VIEW 담당학생명단(
	교번,
    교수자명,
    학번,
    학생명
)
AS SELECT 
		교수.교수번호,
		교수.교수이름,
        학생.학생번호,
        학생.학생이름
FROM 학생 JOIN 교수 ON 학생.담당교수번호 = 교수.교수번호;
SELECT * FROM 담당학생명단;

-- 강좌를진행하지않는 교수
DELETE FROM 교수
WHERE 교수번호='10000000005';
SELECT * FROM 교수;


-- 안되는거
/*DELETE FROM 교수
WHERE 교수 JOIN 강좌 ON 교수.교수번호 != 강좌.담당교수번호;
DELETE FROM 교수
WHERE 교수번호 JOIN 강좌 ON 교수.교수번호 = 강좌.담당교수번호;

DELETE FROM 교수
WHERE 교수번호 IS NOT = 강좌.담당교수번호;

강좌없는 교수삭제는 구현하지못했습니다..